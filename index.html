<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fresco - The Cup of Comfort</title>
<style>
  /* --- 1. LUXURY THEME --- */
  :root {
    --cream: #FAFAF5;
    --white: #FFFFFF;
    --coffee: #2C241B; 
    --latte: #A67B5B;
    --gold: #D4AF37;
    --green: #2E7D32;
    --red: #C62828;
    --shadow: 0 15px 40px rgba(44, 36, 27, 0.08);
  }

  body {
    margin: 0;
    background-color: var(--cream);
    color: var(--coffee);
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
    overflow-x: hidden;
    scroll-behavior: smooth;
  }

  /* Animations */
  @keyframes fadeUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

  .reveal { opacity: 0; animation: fadeUp 0.8s ease-out forwards; }
  .delay-1 { animation-delay: 0.1s; }
  .delay-2 { animation-delay: 0.2s; }
  
  /* --- 2. NAVIGATION --- */
  nav {
    display: flex; justify-content: space-between; align-items: center;
    padding: 15px 40px; background-color: rgba(250, 250, 245, 0.98);
    position: sticky; top: 0; z-index: 1000;
    border-bottom: 1px solid rgba(0,0,0,0.05); box-shadow: 0 4px 20px rgba(0,0,0,0.02);
  }

  .logo-container { height: 50px; display: flex; align-items: center; cursor: pointer; }
  .nav-logo-img { height: 100%; display: block; }
  .nav-logo-text { display: none; font-family: 'Georgia', serif; font-size: 24px; font-weight: bold; letter-spacing: 2px; color: var(--coffee); }

  .nav-links { display: flex; align-items: center; gap: 25px; }
  .nav-item { cursor: pointer; font-size: 13px; text-transform: uppercase; font-weight: 700; color: #888; transition: 0.3s; letter-spacing: 1px; }
  .nav-item:hover { color: var(--latte); }

  /* CART ICON */
  .cart-wrapper { position: relative; cursor: pointer; }
  .cart-icon { font-size: 22px; transition: 0.3s; color: var(--coffee); }
  .cart-wrapper:hover .cart-icon { color: var(--gold); transform: scale(1.1); }
  .cart-badge { 
    position: absolute; top: -8px; right: -8px; background: var(--red); color: white; 
    font-size: 10px; padding: 3px 6px; border-radius: 50%; font-weight: bold; display: none;
  }

  .login-btn {
    padding: 10px 25px; border: 1px solid var(--coffee); color: var(--coffee);
    border-radius: 4px; background: transparent; cursor: pointer;
    font-weight: bold; font-size: 12px; transition: 0.3s; letter-spacing: 1px;
  }
  .login-btn:hover { background: var(--coffee); color: white; }

  /* User Menu */
  .user-menu {
    display: none; position: absolute; top: 70px; right: 40px;
    background: white; border: 1px solid #eee; border-radius: 8px;
    box-shadow: var(--shadow); width: 260px; text-align: left; overflow: hidden;
    animation: zoomIn 0.2s ease; z-index: 2000;
  }
  .menu-header { background: var(--coffee); color: white; padding: 15px; font-size: 0.9rem; }
  .menu-item { padding: 12px 15px; border-bottom: 1px solid #f9f9f9; font-size: 0.85rem; color: #666; }

  /* --- 3. SECTIONS --- */
  .view-section { display: block; min-height: 100vh; padding-top: 40px; }
  .hidden { display: none !important; }

  .hero { text-align: center; padding: 60px 20px 40px 20px; }
  h1 { font-size: 3.5rem; font-family: 'Georgia', serif; color: var(--coffee); margin: 0; letter-spacing: -1px; }
  .subtitle { color: var(--latte); font-size: 1.2rem; margin-top: 15px; font-style: italic; }
  .section-title { text-align: center; font-family: 'Georgia', serif; font-size: 2.2rem; margin-bottom: 50px; color: var(--coffee); position: relative; }
  
  /* --- 4. ABOUT US --- */
  .about-container { max-width: 800px; margin: 0 auto 80px auto; text-align: center; line-height: 1.8; color: #555; background: white; padding: 40px; border-radius: 12px; box-shadow: var(--shadow); }
  .about-highlight { font-size: 1.1rem; font-weight: bold; color: var(--coffee); margin-bottom: 20px; display: block; font-family: 'Georgia', serif; }

  /* --- 5. REAL IMAGE GRID --- */
  .grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; padding: 20px 20px 80px 20px; }
  .card {
    background: var(--white); width: 300px; border-radius: 12px; overflow: hidden;
    text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.05); transition: 0.4s;
    border: 1px solid rgba(0,0,0,0.02);
  }
  .card:hover { transform: translateY(-10px); box-shadow: 0 20px 50px rgba(0,0,0,0.1); }
  
  .card-img-container { height: 220px; overflow: hidden; position: relative; background: #f0f0f0; }
  .card-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s ease; }
  .card:hover .card-img { transform: scale(1.1); }
  
  .card-body { padding: 25px; }
  .name { font-size: 1.4rem; font-weight: bold; margin-bottom: 5px; display: block; color: var(--coffee); }
  .price { color: var(--gold); font-weight: bold; font-size: 1.3rem; display: block; margin-bottom: 20px; }
  
  .add-btn {
    background-color: var(--coffee); color: white; border: none; padding: 12px 0; width: 100%;
    font-size: 12px; letter-spacing: 2px; font-weight: bold; text-transform: uppercase;
    cursor: pointer; transition: 0.3s; border-radius: 6px;
  }
  .add-btn:hover { background-color: var(--gold); }

  /* --- 6. CART PAGE --- */
  .cart-container { max-width: 900px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: var(--shadow); overflow: hidden; }
  .cart-header { background: var(--coffee); color: white; padding: 20px; font-weight: bold; letter-spacing: 1px; }
  .cart-row { display: flex; align-items: center; padding: 20px; border-bottom: 1px solid #eee; }
  .cart-img { width: 80px; height: 80px; border-radius: 8px; object-fit: cover; margin-right: 20px; }
  .cart-info { flex: 1; text-align: left; }
  .cart-name { font-weight: bold; font-size: 1.1rem; color: var(--coffee); }
  .cart-price { color: var(--gold); font-weight: bold; }
  .remove-btn { color: var(--red); cursor: pointer; font-size: 0.9rem; font-weight: bold; background: none; border: none; }
  .cart-footer { padding: 30px; text-align: right; background: #fafafa; }
  .cart-total { font-size: 1.5rem; font-weight: bold; color: var(--coffee); margin-bottom: 20px; display: block; }

  /* --- 7. CHECKOUT PAGE --- */
  .checkout-wrapper { max-width: 800px; margin: 0 auto; background: white; padding: 40px; border-radius: 12px; box-shadow: var(--shadow); }
  .form-grid-2 { display: flex; gap: 20px; margin-bottom: 20px; }
  .form-group { margin-bottom: 20px; width: 100%; }
  label { display: block; font-size: 11px; font-weight: 800; color: #999; margin-bottom: 8px; text-transform: uppercase; }
  input, select { width: 100%; padding: 14px; border: 1px solid #e0e0e0; border-radius: 6px; font-size: 15px; }
  .action-btn {
    width: 100%; padding: 18px; background: #fb641b; color: white; border: none; 
    font-weight: bold; font-size: 16px; cursor: pointer; border-radius: 6px; transition: 0.3s;
  }
  .action-btn:hover { background: #f4511e; }

  /* --- 8. MODALS --- */
  .modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(44, 36, 27, 0.7); backdrop-filter: blur(8px);
    display: none; justify-content: center; align-items: center; z-index: 3000;
  }
  .modal-box {
    background: white; padding: 50px; width: 380px; border-radius: 12px; text-align: center;
    box-shadow: 0 30px 60px rgba(0,0,0,0.3); position: relative; animation: zoomIn 0.3s ease;
  }
  .close-btn { position: absolute; top: 20px; right: 25px; font-size: 28px; cursor: pointer; color: #ccc; }
  
  .msg-icon { font-size: 50px; display: block; margin-bottom: 20px; }
  .msg-title { font-family: 'Georgia', serif; font-size: 1.8rem; margin-bottom: 15px; color: var(--coffee); }
  .msg-text { color: #666; line-height: 1.6; margin-bottom: 30px; }

  .spinner { display: none; margin: 15px auto; width: 30px; height: 30px; border: 3px solid #eee; border-top: 3px solid var(--coffee); border-radius: 50%; animation: spin 1s linear infinite; }
  
  .whatsapp-section { background: var(--coffee); color: white; text-align: center; padding: 80px 20px; margin-top: 80px; }
  .wa-btn { background-color: #25D366; color: white; padding: 15px 40px; border-radius: 50px; font-weight: bold; text-decoration: none; display: inline-block; margin-top: 20px; }
  footer { background: #1a1612; color: #666; text-align: center; padding: 60px 20px; margin-top: 50px; font-size: 0.9rem; }

</style>
</head>
<body>

  <nav>
    <div class="logo-container" onclick="showHome()">
      <img src="fresco logo.png" alt="Fresco" class="nav-logo-img" onerror="this.style.display='none'; document.querySelector('.nav-logo-text').style.display='block'">
      <span class="nav-logo-text">FRESCO</span>
    </div>
    
    <div class="nav-links">
      <span class="nav-item" onclick="showHome()">Menu</span>
      <span class="nav-item" onclick="scrollToID('about')">About</span>
      
      <div class="cart-wrapper" onclick="openCartPage()">
        <span class="cart-icon">ðŸ›’</span>
        <span id="cartBadge" class="cart-badge">0</span>
      </div>

      <button class="login-btn" id="navLoginBtn" onclick="openLogin()">LOGIN</button>
      
      <div id="userDisplay" style="display:none; font-weight:bold; cursor:pointer;" onclick="toggleMenu()">
        <span id="displayName">User</span> â–¼
      </div>

      <div id="userMenu" class="user-menu">
        <div class="menu-header">My Account</div>
        <div class="menu-item">Name: <span id="menuName">--</span></div>
        <div class="menu-item">Phone: <span id="menuPhone">--</span></div>
        <div class="menu-item" style="color:var(--red); cursor:pointer; font-weight:bold;" onclick="location.reload()">LOG OUT</div>
      </div>
    </div>
  </nav>

  <div id="homeView" class="view-section">
    <div class="hero reveal">
      <img src="fresco logo.png" style="width:150px; margin-bottom:20px;" onerror="this.style.display='none'">
      <h1>The Cup of Comfort</h1>
      <p class="subtitle">Artisan roasted coffee. Delivered to your door.</p>
    </div>

    <div id="about" class="reveal delay-1">
      <h2 class="section-title">Our Story</h2>
      <div class="about-container">
        <span class="about-highlight">Founded in the misty hills of Coorg.</span>
        <p>At Fresco, we believe coffee is not just a beverage; it is a ritual. Since 1998, we have been partnering with sustainable estates to bring you beans that tell a story.</p>
        <p>Every cup you brew is a result of patience, precision, and passion. We roast in small batches to ensure that the chocolatey, nutty notes are perfectly preserved.</p>
      </div>
    </div>

    <div id="shop" class="reveal delay-2">
      <h2 class="section-title">Signature Blends</h2>
      <div class="grid">
        
        <div class="card">
          <div class="card-img-container">
            <img src="https://myeverydaytable.com/wp-content/uploads/2025/04/Latte_0_7.jpg" class="card-img" alt="Latte">
          </div>
          <div class="card-body">
            <span class="name">Classic Latte</span>
            <span class="price">â‚¹250</span>
            <button class="add-btn" onclick="addToCart('Classic Latte', 250, 'https://www.caffesociety.co.uk/assets/recipe-images/latte-small.jpg')">ADD TO CART</button>
          </div>
        </div>

        <div class="card">
          <div class="card-img-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Cappuccino_at_Sightglass_Coffee.jpg/640px-Cappuccino_at_Sightglass_Coffee.jpg" class="card-img" alt="Cappuccino">
          </div>
          <div class="card-body">
            <span class="name">Cappuccino</span>
            <span class="price">â‚¹280</span>
            <button class="add-btn" onclick="addToCart('Cappuccino', 280, 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Cappuccino_at_Sightglass_Coffee.jpg/640px-Cappuccino_at_Sightglass_Coffee.jpg')">ADD TO CART</button>
          </div>
        </div>

        <div class="card">
          <div class="card-img-container">
            <img src="https://www.simplyrecipes.com/thmb/7zYXgL4vpOhXfa04v7_vPO4Dv84=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Simply-Recipes-Cold-Brew-Coffee-LEAD-6-896c6872ac3e421ca4d88f29b528b349.jpg" class="card-img" alt="Cold Coffee">
          </div>
          <div class="card-body">
            <span class="name">Cold Brew</span>
            <span class="price">â‚¹300</span>
            <button class="add-btn" onclick="addToCart('Cold Brew', 300, 'https://www.simplyrecipes.com/thmb/7zYXgL4vpOhXfa04v7_vPO4Dv84=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/Simply-Recipes-Cold-Brew-Coffee-LEAD-6-896c6872ac3e421ca4d88f29b528b349.jpg')">ADD TO CART</button>
          </div>
        </div>

        <div class="card">
          <div class="card-img-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Roasted_coffee_beans.jpg/640px-Roasted_coffee_beans.jpg" class="card-img" alt="Dark Roast">
          </div>
          <div class="card-body">
            <span class="name">Dark Roast</span>
            <span class="price">â‚¹350</span>
            <button class="add-btn" onclick="addToCart('Dark Roast', 350, 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c5/Roasted_coffee_beans.jpg/640px-Roasted_coffee_beans.jpg')">ADD TO CART</button>
          </div>
        </div>

        <div class="card">
          <div class="card-img-container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/A_small_cup_of_coffee.JPG/800px-A_small_cup_of_coffee.JPG" class="card-img" alt="Light Roast">
          </div>
          <div class="card-body">
            <span class="name">Light Roast</span>
            <span class="price">â‚¹380</span>
            <button class="add-btn" onclick="addToCart('Light Roast', 380, 'https://upload.wikimedia.org/wikipedia/commons/thumb/4/45/A_small_cup_of_coffee.JPG/800px-A_small_cup_of_coffee.JPG')">ADD TO CART</button>
          </div>
        </div>

        <div class="card">
          <div class="card-img-container">
            <img src="https://5.imimg.com/data5/SELLER/Default/2024/9/449638702/NK/XB/AE/37017040/medium-roasted-coffee-beans.jpg" class="card-img" alt="Medium Roast">
          </div>
          <div class="card-body">
            <span class="name">Medium Roast</span>
            <span class="price">â‚¹400</span>
            <button class="add-btn" onclick="addToCart('Medium Roast', 400, 'https://5.imimg.com/data5/SELLER/Default/2024/9/449638702/NK/XB/AE/37017040/medium-roasted-coffee-beans.jpg')">ADD TO CART</button>
          </div>
        </div>

      </div>
    </div>
    
    <div id="contact" class="whatsapp-section reveal">
      <h2 style="font-family:'Georgia', serif; font-size: 2.5rem;">The Inner Circle</h2>
      <p style="opacity: 0.9; margin-bottom: 30px; font-size: 1.1rem;">Join our exclusive community.</p>
      <a href="https://chat.whatsapp.com/Hr7hh2uJzna2u4gXtVJjw6" class="wa-btn">Join on WhatsApp</a>
    </div>

    <footer>&copy; 2026 Fresco Coffee. Crafted with Passion.</footer>
  </div>

  <div id="cartView" class="view-section hidden">
    <div style="text-align:center; margin-bottom:40px;">
      <h2 class="section-title">Your Cart</h2>
    </div>
    <div class="cart-container" id="cartItemsContainer">
      </div>
    <div class="cart-container" style="margin-top:20px; text-align:center; padding:20px;">
        <button onclick="showHome()" style="background:none; border:none; color:#888; cursor:pointer; margin-right:20px;">Continue Shopping</button>
    </div>
  </div>

  <div id="checkoutView" class="view-section hidden">
    <div class="checkout-wrapper">
      
      <div class="checkout-left">
        <div class="step-title">1. SHIPPING ADDRESS</div>
        
        <div class="form-grid-2">
          <div class="form-group"><label>Name</label><input type="text" id="addrName" readonly style="background:#f9f9f9; color:#777;"></div>
          <div class="form-group"><label>Mobile</label><input type="text" id="addrPhone" readonly style="background:#f9f9f9; color:#777;"></div>
        </div>

        <div class="form-grid-2">
          <div class="form-group"><label>Pincode</label><input type="tel" id="addrPin" placeholder="6 digits" maxlength="6"></div>
          <div class="form-group"><label>Locality</label><input type="text" id="addrArea" placeholder="Area / Street"></div>
        </div>

        <div class="form-group"><label>Address</label><input type="text" id="addrHouse" placeholder="Flat, House No, Building"></div>

        <div class="form-grid-2">
          <div class="form-group"><label>City</label><input type="text" id="addrCity" placeholder="City"></div>
          <div class="form-group"><label>State</label>
            <select id="addrState">
              <option value="">Select State</option><option value="Karnataka">Karnataka</option><option value="Maharashtra">Maharashtra</option><option value="Delhi">Delhi</option><option value="Tamil Nadu">Tamil Nadu</option><option value="Other">Other</option>
            </select>
          </div>
        </div>

        <button onclick="showHome()" style="margin-top:20px; background:none; border:none; color:#888; cursor:pointer; font-weight:bold;">&larr; BACK TO MENU</button>
      </div>

      <div class="checkout-right">
        <div class="step-title">ORDER SUMMARY</div>
        <div class="summary-row"><span>Items Selected</span><span id="summCount" style="font-weight:bold">0</span></div>
        <div class="summary-row"><span>Delivery Fee</span><span style="color:var(--green);">FREE</span></div>
        <div class="total-row"><span>Total</span><span id="summTotal">â‚¹0</span></div>

        <button class="action-btn" id="placeOrderBtn" onclick="submitOrder()">PAY & ORDER</button>
        <div class="spinner" id="orderSpinner"></div>
        <p style="font-size:11px; color:#aaa; margin-top:15px; text-align:center;">ðŸ”’ Secure SSL Encryption</p>
      </div>
    </div>
  </div>

  <div id="loginModal" class="modal-overlay">
    <div class="modal-box">
      <span class="close-btn" onclick="closeLogin()">Ã—</span>
      <h2 style="font-family:'Georgia', serif; margin-bottom:10px;">Welcome</h2>
      <p style="color:#888; margin-bottom:30px;">Login or Register to shop.</p>
      <input type="text" id="loginName" placeholder="Full Name" style="margin-bottom:15px;">
      <input type="tel" id="loginPhone" placeholder="Mobile Number (10 digits)" maxlength="10" style="margin-bottom:20px;">
      <button class="action-btn" style="background:var(--coffee); margin-top:0;" onclick="processLogin()">CONTINUE</button>
      <div class="spinner" id="loginSpinner"></div>
    </div>
  </div>

  <div id="msgModal" class="modal-overlay">
    <div class="modal-box">
      <span class="msg-icon">âœ¨</span>
      <h2 id="msgTitle" class="msg-title">Title</h2>
      <p id="msgText" class="msg-text">Message.</p>
      <button class="action-btn" style="background:var(--coffee); margin-top:0;" onclick="closeMsgModal()">OKAY</button>
    </div>
  </div>

  <script>
    // --- STATE ---
    let user = null;
    let cart = [];

    // --- NAVIGATION ---
    function showHome() {
      hideAllViews();
      document.getElementById('homeView').classList.remove('hidden');
      window.scrollTo(0,0);
    }
    
    function scrollToID(id) {
      showHome();
      setTimeout(() => { document.getElementById(id).scrollIntoView({behavior: 'smooth'}); }, 100);
    }

    function openCartPage() {
      if(!user) { openLogin(); return; } 
      hideAllViews();
      document.getElementById('cartView').classList.remove('hidden');
      renderCart();
      window.scrollTo(0,0);
    }

    function openCheckout() {
      if(cart.length === 0) { alert("Cart is empty!"); return; }
      hideAllViews();
      document.getElementById('checkoutView').classList.remove('hidden');
      document.getElementById('addrName').value = user.name;
      document.getElementById('addrPhone').value = user.phone;
      
      let total = cart.reduce((sum, item) => sum + item.price, 0);
      document.getElementById('summCount').innerText = cart.length;
      document.getElementById('summTotal').innerText = "â‚¹" + total;
      
      window.scrollTo(0,0);
    }

    function hideAllViews() {
      document.getElementById('homeView').classList.add('hidden');
      document.getElementById('cartView').classList.add('hidden');
      document.getElementById('checkoutView').classList.add('hidden');
    }

    // --- MESSAGING ---
    function showMessage(title, text) {
      document.getElementById('msgTitle').innerText = title;
      document.getElementById('msgText').innerText = text;
      document.getElementById('msgModal').style.display = 'flex';
    }
    function closeMsgModal() {
      document.getElementById('msgModal').style.display = 'none';
    }

    // --- CART ---
    function addToCart(item, price, img) {
      if(!user) { openLogin(); return; }
      cart.push({name: item, price: price, img: img});
      updateCartBadge();
      
      // Visual feedback
      let badge = document.getElementById('cartBadge');
      badge.style.transform = 'scale(1.5)';
      setTimeout(() => badge.style.transform = 'scale(1)', 200);
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      renderCart();
      updateCartBadge();
    }

    function updateCartBadge() {
      let badge = document.getElementById('cartBadge');
      if(cart.length > 0) {
        badge.style.display = 'block';
        badge.innerText = cart.length;
      } else {
        badge.style.display = 'none';
      }
    }

    function renderCart() {
      let container = document.getElementById('cartItemsContainer');
      container.innerHTML = "";
      if(cart.length === 0) {
        container.innerHTML = '<div style="padding:40px; text-align:center; color:#888;">Your cart is empty.</div>';
        return;
      }
      container.innerHTML += `<div class="cart-header">Items (${cart.length})</div>`;
      let total = 0;
      cart.forEach((item, index) => {
        total += item.price;
        container.innerHTML += `
          <div class="cart-row">
            <img src="${item.img}" class="cart-img">
            <div class="cart-info">
              <div class="cart-name">${item.name}</div>
              <div class="cart-price">â‚¹${item.price}</div>
            </div>
            <button class="remove-btn" onclick="removeFromCart(${index})">REMOVE</button>
          </div>
        `;
      });
      container.innerHTML += `
        <div class="cart-footer">
          <span class="cart-total">Total: â‚¹${total}</span>
          <button class="action-btn" style="width:200px;" onclick="openCheckout()">PROCEED TO CHECKOUT</button>
        </div>
      `;
    }

    // --- LOGIN ---
    function openLogin() { document.getElementById('loginModal').style.display = 'flex'; }
    function closeLogin() { document.getElementById('loginModal').style.display = 'none'; }

    function processLogin() {
      let name = document.getElementById('loginName').value;
      let phone = document.getElementById('loginPhone').value;

      if(name === "" || !/^\d{10}$/.test(phone)) {
        alert("Please enter a valid Name and 10-digit Phone Number.");
        return;
      }

      let btn = document.querySelector('#loginModal .action-btn');
      let spin = document.getElementById('loginSpinner');
      btn.style.display = 'none';
      spin.style.display = 'block';

      // GOOGLE FORM POST (Registration)
      var formData = new FormData();
      formData.append("entry.2122226736", name + " (REGISTRATION)");
      formData.append("entry.1161620989", phone);

      fetch("https://docs.google.com/forms/d/e/1FAIpQLSfmp7O5B7GdePepIUj9mbu0EcLJ4Te59gqFvf2J-tzQq3OZMg/formResponse", {
        method: "POST", body: formData, mode: "no-cors"
      }).then(() => {
        user = { name, phone };
        updateUserUI();
        btn.style.display = 'block';
        spin.style.display = 'none';
        closeLogin();
        
        showMessage("Welcome to Fresco!", `Thank you for signing in, ${name}. You can now browse our menu and add items to your cart.`);
      }).catch(() => {
        user = { name, phone };
        updateUserUI();
        closeLogin();
        showMessage("Welcome!", "You are logged in offline.");
      });
    }

    function updateUserUI() {
      document.getElementById('navLoginBtn').style.display = 'none';
      document.getElementById('userDisplay').style.display = 'block';
      document.getElementById('displayName').innerText = "Hi, " + user.name.split(" ")[0];
      document.getElementById('menuName').innerText = user.name;
      document.getElementById('menuPhone').innerText = user.phone;
    }

    function toggleMenu() {
      let menu = document.getElementById('userMenu');
      menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
    }

    // --- SUBMIT ORDER ---
    function submitOrder() {
      let pin = document.getElementById('addrPin').value;
      let house = document.getElementById('addrHouse').value;
      let area = document.getElementById('addrArea').value;
      let city = document.getElementById('addrCity').value;
      let state = document.getElementById('addrState').value;

      if(!pin || !house || !area || !city || !state) {
        alert("Please complete the shipping address.");
        return;
      }

      let btn = document.getElementById('placeOrderBtn');
      let spin = document.getElementById('orderSpinner');
      btn.style.display = 'none';
      spin.style.display = 'block';

      let fullAddr = `${house}, ${area}, ${city}, ${state} - ${pin}`;
      let itemsList = cart.map(i => i.name).join(", ");
      let total = cart.reduce((sum, i) => sum + i.price, 0);
      let combinedData = `${user.name} (ORDER: ${itemsList} | TOTAL: â‚¹${total} | ADDR: ${fullAddr})`;

      var formData = new FormData();
      formData.append("entry.2122226736", combinedData);
      formData.append("entry.1161620989", user.phone);

      fetch("https://docs.google.com/forms/d/e/1FAIpQLSfmp7O5B7GdePepIUj9mbu0EcLJ4Te59gqFvf2J-tzQq3OZMg/formResponse", {
        method: "POST", body: formData, mode: "no-cors"
      })
      .then(() => {
        cart = [];
        updateCartBadge();
        btn.style.display = 'block';
        spin.style.display = 'none';
        
        // Success Message
        document.getElementById('msgModal').style.display = 'flex';
        document.getElementById('msgTitle').innerText = "Order Confirmed!";
        document.getElementById('msgText').innerText = `Thank you, ${user.name}. We will deliver to ${area} soon.`;
        
        document.querySelector('#msgModal .action-btn').onclick = function() {
           closeMsgModal();
           showHome();
        };
      })
      .catch(() => {
        alert("Network Error.");
        btn.style.display = 'block';
        spin.style.display = 'none';
      });
    }
  </script>

</body>
</html>
